'''
    функция сканирования хоста по имени или ip адресу
'''


from libnmap.process import NmapProcess
from bs4 import BeautifulSoup


def nmap_func(res_name):

    nm = NmapProcess(res_name, options="-O")
    rc = nm.run()

    if nm.rc == 0:


        bs = BeautifulSoup(nm.stdout, 'lxml')
        things=bs.find_all('osmatch')
     
        for i in things:
            os_dict=[i['accuracy'], i['name'], i.osclass['osfamily'], i.osclass['vendor'], i.find('cpe').text]
            return os_dict